<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Summit Construction - Financial Control Center | ACCOUNTING ESSENTIALS</title>
    <link rel="stylesheet" href="../../styles.css">
    <style>
        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
           FINANCIAL CONTROL CENTER - STYLES
           ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

        /* Tab Navigation */
        .control-tabs {
            display: flex;
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
            border-bottom: 3px solid var(--border-light);
            padding-bottom: var(--space-md);
        }

        .control-tab {
            flex: 1;
            padding: var(--space-md) var(--space-lg);
            background: var(--bg-light);
            border: 2px solid transparent;
            border-radius: var(--radius-md) var(--radius-md) 0 0;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
        }

        .control-tab:hover {
            background: var(--primary-light);
            color: white;
        }

        .control-tab.active {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            border-color: var(--primary-dark);
            box-shadow: var(--shadow-md);
        }

        .tab-icon {
            font-size: 1.25rem;
        }

        .tab-content-section {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .tab-content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(15px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Module 1: Bank Reconciliation */
        .reconciliation-dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-xl);
            margin-bottom: var(--space-xl);
        }

        @media (max-width: 968px) {
            .reconciliation-dashboard {
                grid-template-columns: 1fr;
            }
        }

        .statement-panel {
            background: var(--white);
            border: 2px solid var(--border-light);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            box-shadow: var(--shadow-md);
        }

        .statement-panel h3 {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-md);
            border-bottom: 2px solid var(--primary);
            color: var(--primary);
        }

        .statement-display {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: var(--space-lg);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-lg);
        }

        .statement-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-sm) 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .statement-row:last-child {
            border-bottom: none;
            margin-top: var(--space-sm);
            padding-top: var(--space-md);
            border-top: 2px solid rgba(255, 255, 255, 0.3);
        }

        .statement-label {
            font-size: 0.95rem;
            opacity: 0.9;
        }

        .statement-amount {
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            font-weight: 700;
        }

        .amount-positive {
            color: var(--success-light);
        }

        .amount-negative {
            color: var(--warning-light);
        }

        .reconciliation-table-container {
            margin-top: var(--space-lg);
            overflow-x: auto;
        }

        .reconciliation-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .reconciliation-table th {
            background: var(--primary);
            color: white;
            padding: var(--space-sm) var(--space-md);
            text-align: left;
            font-weight: 600;
        }

        .reconciliation-table td {
            padding: var(--space-sm) var(--space-md);
            border-bottom: 1px solid var(--border-light);
        }

        .reconciliation-table tr:hover {
            background: var(--bg-light);
        }

        .item-type-deposit {
            color: var(--success);
            font-weight: 600;
        }

        .item-type-check {
            color: var(--error);
            font-weight: 600;
        }

        .item-type-charge {
            color: var(--warning);
            font-weight: 600;
        }

        /* Reconciliation Worksheet */
        .worksheet-container {
            background: var(--bg-light);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            margin-top: var(--space-xl);
        }

        .worksheet-step {
            display: grid;
            grid-template-columns: auto 1fr auto;
            gap: var(--space-md);
            align-items: center;
            padding: var(--space-md);
            background: white;
            border-radius: var(--radius-md);
            margin-bottom: var(--space-md);
            border-left: 4px solid var(--border-light);
            transition: all 0.3s ease;
        }

        .worksheet-step.completed {
            border-left-color: var(--success);
            background: var(--success-light);
        }

        .step-number {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            font-weight: 700;
        }

        .step-number.completed {
            background: var(--success);
        }

        .step-description {
            font-weight: 600;
            color: var(--text-main);
        }

        .step-input-group {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .step-input {
            width: 120px;
            padding: var(--space-sm);
            border: 2px solid var(--border-light);
            border-radius: var(--radius-sm);
            font-family: monospace;
            text-align: right;
        }

        .step-input:focus {
            border-color: var(--primary);
            outline: none;
        }

        .check-mark {
            color: var(--success);
            font-size: 1.25rem;
            font-weight: 700;
            display: none;
        }

        .check-mark.show {
            display: inline;
        }

        .reconciliation-result {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-dark) 100%);
            color: white;
            padding: var(--space-xl);
            border-radius: var(--radius-lg);
            text-align: center;
            margin-top: var(--space-lg);
        }

        .reconciliation-result h4 {
            margin-bottom: var(--space-md);
            font-size: 1.25rem;
        }

        .result-amount {
            font-size: 2rem;
            font-weight: 800;
            font-family: monospace;
        }

        /* Module 2: Petty Cash Management */
        .petty-cash-dashboard {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            padding: var(--space-xl);
            border-radius: var(--radius-xl);
            margin-bottom: var(--space-xl);
        }

        .petty-cash-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-md);
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .petty-cash-header h3 {
            color: white;
            margin: 0;
        }

        .fund-status-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-sm) var(--space-md);
            background: var(--success);
            border-radius: var(--radius-full);
            font-size: 0.85rem;
            font-weight: 600;
        }

        .fund-status-badge.low {
            background: var(--warning);
        }

        .fund-status-badge.critical {
            background: var(--error);
        }

        .fund-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }

        .fund-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: var(--space-md);
            border-radius: var(--radius-lg);
            text-align: center;
        }

        .fund-card label {
            display: block;
            font-size: 0.85rem;
            opacity: 0.8;
            margin-bottom: var(--space-sm);
        }

        .fund-card .value {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--secondary);
            font-family: monospace;
        }

        .transaction-panel {
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            box-shadow: var(--shadow-md);
        }

        .transaction-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
        }

        .form-group label {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-main);
        }

        .form-group input,
        .form-group select {
            padding: var(--space-sm) var(--space-md);
            border: 2px solid var(--border-light);
            border-radius: var(--radius-sm);
            font-size: 1rem;
        }

        .form-group input:focus,
        .form-group select:focus {
            border-color: var(--primary);
            outline: none;
        }

        .receipt-checkbox {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .transaction-history {
            background: var(--bg-light);
            border-radius: var(--radius-lg);
            padding: var(--space-md);
            margin-top: var(--space-lg);
        }

        .transaction-item {
            display: grid;
            grid-template-columns: 100px 1fr 100px auto 40px;
            gap: var(--space-md);
            align-items: center;
            padding: var(--space-md);
            background: white;
            border-radius: var(--radius-md);
            margin-bottom: var(--space-sm);
            border-left: 4px solid var(--border-light);
        }

        .transaction-item.valid-receipt {
            border-left-color: var(--success);
        }

        .transaction-item.no-receipt {
            border-left-color: var(--warning);
        }

        .tx-date {
            font-size: 0.9rem;
            color: var(--text-muted);
            font-weight: 600;
        }

        .tx-details {
            display: flex;
            flex-direction: column;
        }

        .tx-desc {
            font-weight: 600;
            color: var(--text-main);
        }

        .tx-vendor {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .tx-amount {
            font-family: monospace;
            font-weight: 700;
            color: var(--error);
        }

        .tx-receipt-icon {
            font-size: 1.25rem;
        }

        .replenishment-alert {
            background: var(--warning-light);
            border: 2px solid var(--warning);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-top: var(--space-lg);
            display: none;
        }

        .replenishment-alert.show {
            display: block;
            animation: slideIn 0.4s ease;
        }

        .replenishment-alert h4 {
            color: var(--warning);
            margin-bottom: var(--space-sm);
        }

        /* Cash Shortage/Surplus */
        .variance-section {
            background: var(--bg-light);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-top: var(--space-xl);
        }

        .variance-calculator {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-lg);
            margin-top: var(--space-lg);
        }

        @media (max-width: 768px) {
            .variance-calculator {
                grid-template-columns: 1fr;
            }
        }

        .variance-card {
            background: white;
            padding: var(--space-lg);
            border-radius: var(--radius-md);
            text-align: center;
            box-shadow: var(--shadow-sm);
        }

        .variance-card h5 {
            margin-bottom: var(--space-md);
            color: var(--primary);
        }

        .variance-card input {
            width: 100%;
            padding: var(--space-sm);
            border: 2px solid var(--border-light);
            border-radius: var(--radius-sm);
            text-align: center;
            font-size: 1.25rem;
            font-family: monospace;
        }

        .variance-result {
            margin-top: var(--space-md);
            padding: var(--space-md);
            border-radius: var(--radius-md);
            font-weight: 700;
        }

        .variance-result.balanced {
            background: var(--success-light);
            color: var(--success);
        }

        .variance-result.short {
            background: var(--error-light);
            color: var(--error);
        }

        .variance-result.over {
            background: var(--warning-light);
            color: var(--warning);
        }

        /* Module 3: Internal Control */
        .control-system-panel {
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            margin-bottom: var(--space-xl);
            box-shadow: var(--shadow-md);
        }

        .control-flow-diagram {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-lg);
            margin: var(--space-xl) 0;
        }

        .control-stage {
            background: var(--bg-light);
            border: 2px solid var(--border-light);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            text-align: center;
            position: relative;
            transition: all 0.3s ease;
        }

        .control-stage.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary-dark);
        }

        .control-stage.completed {
            background: var(--success-light);
            border-color: var(--success);
        }

        .control-stage.completed .stage-icon {
            color: var(--success);
        }

        .stage-icon {
            font-size: 2rem;
            margin-bottom: var(--space-sm);
        }

        .stage-title {
            font-weight: 700;
            margin-bottom: var(--space-xs);
        }

        .stage-desc {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .control-stage.active .stage-desc {
            color: rgba(255, 255, 255, 0.8);
        }

        .approval-workflow {
            background: var(--bg-light);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-top: var(--space-lg);
        }

        .workflow-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
        }

        .scenario-card {
            background: white;
            border: 2px solid var(--border-light);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            margin-bottom: var(--space-md);
        }

        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-md);
        }

        .scenario-title {
            font-weight: 700;
            color: var(--primary);
        }

        .risk-level {
            padding: var(--space-xs) var(--space-md);
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 700;
        }

        .risk-level.high {
            background: var(--error-light);
            color: var(--error);
        }

        .risk-level.medium {
            background: var(--warning-light);
            color: var(--warning);
        }

        .risk-level.low {
            background: var(--success-light);
            color: var(--success);
        }

        .control-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-md);
        }

        .control-option {
            background: var(--bg-light);
            border: 2px solid var(--border-light);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .control-option:hover {
            border-color: var(--primary);
            background: var(--primary-glow);
        }

        .control-option.selected {
            border-color: var(--primary);
            background: var(--primary-light);
            color: white;
        }

        .control-option.correct {
            border-color: var(--success);
            background: var(--success-light);
        }

        .control-option.incorrect {
            border-color: var(--error);
            background: var(--error-light);
        }

        .control-option h5 {
            margin-bottom: var(--space-xs);
        }

        .control-option p {
            font-size: 0.9rem;
            margin: 0;
        }

        /* Error Detection Module */
        .error-detection-panel {
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            margin-top: var(--space-xl);
        }

        .document-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-lg);
            margin-top: var(--space-lg);
        }

        @media (max-width: 768px) {
            .document-comparison {
                grid-template-columns: 1fr;
            }
        }

        .document-panel {
            background: var(--bg-light);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
        }

        .document-panel h4 {
            margin-bottom: var(--space-md);
            padding-bottom: var(--space-sm);
            border-bottom: 2px solid var(--primary);
            color: var(--primary);
        }

        .document-item {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: var(--space-md);
            padding: var(--space-sm);
            background: white;
            border-radius: var(--radius-sm);
            margin-bottom: var(--space-xs);
            font-family: monospace;
            font-size: 0.9rem;
        }

        .document-item.discrepancy {
            background: var(--warning-light);
            border: 2px solid var(--warning);
        }

        .error-indicators {
            margin-top: var(--space-lg);
        }

        .error-item {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            padding: var(--space-md);
            background: var(--bg-light);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-sm);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .error-item:hover {
            background: var(--warning-light);
        }

        .error-item.found {
            background: var(--success-light);
            border: 2px solid var(--success);
        }

        .error-checkbox {
            width: 24px;
            height: 24px;
            accent-color: var(--success);
        }

        .error-description {
            flex: 1;
        }

        .error-description strong {
            display: block;
            color: var(--primary);
            margin-bottom: var(--space-xs);
        }

        .error-description span {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* Segregation of Duties Game */
        .segregation-game {
            background: var(--bg-light);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            margin-top: var(--space-xl);
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-lg);
            margin-top: var(--space-lg);
        }

        .employee-card {
            background: white;
            border: 2px solid var(--border-light);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            min-height: 300px;
        }

        .employee-card h4 {
            text-align: center;
            margin-bottom: var(--space-md);
            padding-bottom: var(--space-sm);
            border-bottom: 2px solid var(--primary);
            color: var(--primary);
        }

        .task-pool {
            min-height: 150px;
            background: var(--bg-light);
            border: 2px dashed var(--border-medium);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin-bottom: var(--space-md);
        }

        .task-item {
            background: white;
            border: 2px solid var(--primary);
            border-radius: var(--radius-sm);
            padding: var(--space-sm) var(--space-md);
            margin-bottom: var(--space-sm);
            cursor: grab;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .task-item:hover {
            background: var(--primary-glow);
            transform: translateX(5px);
        }

        .task-item.dragging {
            opacity: 0.7;
            cursor: grabbing;
        }

        .task-assigned {
            background: var(--success-light);
            border-color: var(--success);
        }

        .conflict-alert {
            background: var(--error-light);
            border: 2px solid var(--error);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin-top: var(--space-md);
            display: none;
        }

        .conflict-alert.show {
            display: block;
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* Summary Dashboard */
        .dashboard-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-lg);
            margin-top: var(--space-2xl);
        }

        .summary-card {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: var(--space-lg);
            border-radius: var(--radius-lg);
            text-align: center;
        }

        .summary-card h4 {
            color: white;
            margin-bottom: var(--space-sm);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .summary-card .value {
            font-size: 2rem;
            font-weight: 800;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: var(--space-md);
            margin-top: var(--space-lg);
            flex-wrap: wrap;
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, #047857 100%);
            color: white;
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #047857 0%, #065f46 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--error) 0%, #b91c1c 100%);
            color: white;
        }

        .btn-danger:hover {
            background: linear-gradient(135deg, #b91c1c 0%, #991b1b 100%);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning) 0%, #b45309 100%);
            color: white;
        }

        /* Toggle Switches */
        .toggle-switch {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            cursor: pointer;
        }

        .toggle-switch input {
            display: none;
        }

        .toggle-slider {
            width: 50px;
            height: 26px;
            background: var(--border-medium);
            border-radius: var(--radius-full);
            position: relative;
            transition: all 0.3s ease;
        }

        .toggle-slider::after {
            content: '';
            position: absolute;
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: all 0.3s ease;
        }

        .toggle-switch input:checked + .toggle-slider {
            background: var(--success);
        }

        .toggle-switch input:checked + .toggle-slider::after {
            left: 26px;
        }

        /* Tips and Help */
        .help-panel {
            background: var(--info-light);
            border-left: 4px solid var(--info);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            margin: var(--space-lg) 0;
        }

        .help-panel h4 {
            color: var(--info);
            margin-bottom: var(--space-sm);
        }

        .help-panel ul {
            margin: 0;
            padding-left: var(--space-lg);
        }

        .help-panel li {
            margin-bottom: var(--space-xs);
            color: var(--text-secondary);
        }

        /* Animation Classes */
        .pulse-animation {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .highlight-row {
            animation: highlight 0.5s ease;
        }

        @keyframes highlight {
            0% { background: var(--secondary-light); }
            100% { background: transparent; }
        }
    </style>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-50MTQPVR7D"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-50MTQPVR7D');
    </script>
</head>

<body>
    <canvas id="global-bg-canvas"
        style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: var(--bg-light); pointer-events: none;"></canvas>

    <header>
        <div class="container nav-container">
            <a href="../../index.html" class="logo">ACCOUNTING<span>ESSENTIALS</span></a>
            <button id="menu-toggle" class="menu-toggle" aria-label="Toggle Menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <nav class="nav-links">
                <a href="../../index.html">Home</a>
                <a href="../../Part1/part1.html">Part 1</a>
                <a href="../../part2/part2.html">Part 2</a>
                <a href="../../part3/part3.html">Part 3</a>
            </nav>
        </div>
    </header>

    <main class="container">
        <div class="breadcrumbs">
            <a href="../../index.html">Home</a> <span>/</span> <a href="../../part3/part3.html">Part 3</a> <span>/</span> <a href="ch08.html">Chapter 8</a> <span>/</span> Interactive
        </div>

        <article class="animate-fade-in">
            <div class="kp-header">
                <h1 style="border-left: 8px solid var(--secondary); padding-left: var(--space-lg); margin: var(--space-xl) 0;">
                    üèóÔ∏è Summit Construction Co. - Financial Control Center
                </h1>
            </div>

            <section class="kp-section">
                <div class="help-panel">
                    <h4>üìã Welcome to the Financial Control Center</h4>
                    <p>You are the Financial Controller at Summit Construction Co. Your responsibilities include reconciling bank statements, managing the petty cash fund, and ensuring proper internal controls are in place.</p>
                </div>

                <!-- Tab Navigation -->
                <div class="control-tabs">
                    <button class="control-tab active" onclick="switchModule('bank')">
                        <span class="tab-icon">üè¶</span>
                        <span>Bank Reconciliation</span>
                    </button>
                    <button class="control-tab" onclick="switchModule('petty')">
                        <span class="tab-icon">üí∞</span>
                        <span>Petty Cash Manager</span>
                    </button>
                    <button class="control-tab" onclick="switchModule('control')">
                        <span class="tab-icon">üîê</span>
                        <span>Internal Controls</span>
                    </button>
                </div>

                <!-- Module 1: Bank Reconciliation -->
                <div id="module-bank" class="tab-content-section active">
                    <h2 style="color: var(--primary); margin-bottom: var(--space-lg);">
                        Bank Reconciliation Simulator
                    </h2>

                    <div class="help-panel">
                        <h4>üìñ Instructions</h4>
                        <ul>
                            <li>Compare the bank statement with the company's cash book records</li>
                            <li>Identify deposits in transit, outstanding checks, and bank charges</li>
                            <li>Complete the reconciliation worksheet to find the adjusted balance</li>
                        </ul>
                    </div>

                    <div class="reconciliation-dashboard">
                        <!-- Bank Statement Panel -->
                        <div class="statement-panel">
                            <h3>üìÑ Bank Statement (Dec 31, 2026)</h3>
                            <div class="statement-display">
                                <div class="statement-row">
                                    <span class="statement-label">Opening Balance</span>
                                    <span class="statement-amount">$45,000.00</span>
                                </div>
                                <div class="statement-row">
                                    <span class="statement-label">Deposits Cleared</span>
                                    <span class="statement-amount amount-positive">+$28,500.00</span>
                                </div>
                                <div class="statement-row">
                                    <span class="statement-label">Checks Cleared</span>
                                    <span class="statement-amount amount-negative">-$23,200.00</span>
                                </div>
                                <div class="statement-row">
                                    <span class="statement-label">Service Charge</span>
                                    <span class="statement-amount amount-negative">-$25.00</span>
                                </div>
                                <div class="statement-row">
                                    <span class="statement-label">NSF Check</span>
                                    <span class="statement-amount amount-negative">-$450.00</span>
                                </div>
                                <div class="statement-row">
                                    <span class="statement-label"><strong>Closing Balance</strong></span>
                                    <span class="statement-amount"><strong>$49,825.00</strong></span>
                                </div>
                            </div>

                            <h4 style="margin: var(--space-lg) 0 var(--space-md); color: var(--primary);">Transactions Not on Statement:</h4>
                            <div class="reconciliation-table-container">
                                <table class="reconciliation-table">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Description</th>
                                            <th>Amount</th>
                                            <th>Type</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Dec 30</td>
                                            <td>Deposit #1245</td>
                                            <td class="item-type-deposit">+$3,200.00</td>
                                            <td>Deposit in Transit</td>
                                        </tr>
                                        <tr>
                                            <td>Dec 29</td>
                                            <td>Check #2847</td>
                                            <td class="item-type-check">-$1,800.00</td>
                                            <td>Outstanding Check</td>
                                        </tr>
                                        <tr>
                                            <td>Dec 31</td>
                                            <td>Check #2849</td>
                                            <td class="item-type-check">-$950.00</td>
                                            <td>Outstanding Check</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Company Records Panel -->
                        <div class="statement-panel">
                            <h3>üìù Company Cash Book</h3>
                            <div class="statement-display">
                                <div class="statement-row">
                                    <span class="statement-label">Balance per Books</span>
                                    <span class="statement-amount" id="book-balance">$52,275.00</span>
                                </div>
                                <div class="statement-row" id="adj-service-row" style="display: none;">
                                    <span class="statement-label">Less: Bank Service Charge</span>
                                    <span class="statement-amount amount-negative" id="adj-service">-$25.00</span>
                                </div>
                                <div class="statement-row" id="adj-nsf-row" style="display: none;">
                                    <span class="statement-label">Less: NSF Check</span>
                                    <span class="statement-amount amount-negative" id="adj-nsf">-$450.00</span>
                                </div>
                                <div class="statement-row" id="adjusted-book-row" style="display: none; border-top: 2px solid rgba(255,255,255,0.3); margin-top: var(--space-sm); padding-top: var(--space-md);">
                                    <span class="statement-label"><strong>Adjusted Book Balance</strong></span>
                                    <span class="statement-amount" id="adjusted-book-balance"><strong>$51,800.00</strong></span>
                                </div>
                            </div>

                            <div style="margin-top: var(--space-lg);">
                                <h4 style="margin-bottom: var(--space-md); color: var(--primary);">Items to Record:</h4>
                                <div style="background: var(--warning-light); padding: var(--space-md); border-radius: var(--radius-md); margin-bottom: var(--space-sm);">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <span>üîî Bank Service Charge</span>
                                        <span style="font-weight: 700; color: var(--warning);">$25.00</span>
                                    </div>
                                    <small style="color: var(--text-muted);">Monthly account maintenance fee</small>
                                </div>
                                <div style="background: var(--error-light); padding: var(--space-md); border-radius: var(--radius-md);">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <span>‚ö†Ô∏è NSF Check from Client</span>
                                        <span style="font-weight: 700; color: var(--error);">$450.00</span>
                                    </div>
                                    <small style="color: var(--text-muted);">Check bounced - needs collection</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Reconciliation Worksheet -->
                    <div class="worksheet-container">
                        <h3 style="margin-bottom: var(--space-lg); color: var(--primary);">üìä Reconciliation Worksheet</h3>
                        
                        <div class="worksheet-step" id="step-1">
                            <span class="step-number" id="step-num-1">1</span>
                            <span class="step-description">Bank Balance per Statement</span>
                            <div class="step-input-group">
                                <input type="number" class="step-input" id="ws-bank-balance" placeholder="0.00" step="0.01">
                                <span class="check-mark" id="check-1">‚úì</span>
                            </div>
                        </div>

                        <div class="worksheet-step" id="step-2">
                            <span class="step-number" id="step-num-2">2</span>
                            <span class="step-description">Add: Deposits in Transit</span>
                            <div class="step-input-group">
                                <input type="number" class="step-input" id="ws-deposits" placeholder="0.00" step="0.01">
                                <span class="check-mark" id="check-2">‚úì</span>
                            </div>
                        </div>

                        <div class="worksheet-step" id="step-3">
                            <span class="step-number" id="step-num-3">3</span>
                            <span class="step-description">Less: Outstanding Checks</span>
                            <div class="step-input-group">
                                <input type="number" class="step-input" id="ws-checks" placeholder="0.00" step="0.01">
                                <span class="check-mark" id="check-3">‚úì</span>
                            </div>
                        </div>

                        <div class="worksheet-step" id="step-4">
                            <span class="step-number" id="step-num-4">4</span>
                            <span class="step-description">Adjusted Bank Balance</span>
                            <div class="step-input-group">
                                <input type="number" class="step-input" id="ws-adj-bank" placeholder="0.00" step="0.01">
                                <span class="check-mark" id="check-4">‚úì</span>
                            </div>
                        </div>

                        <div class="worksheet-step" id="step-5">
                            <span class="step-number" id="step-num-5">5</span>
                            <span class="step-description">Book Balance</span>
                            <div class="step-input-group">
                                <input type="number" class="step-input" id="ws-book-balance" placeholder="0.00" step="0.01">
                                <span class="check-mark" id="check-5">‚úì</span>
                            </div>
                        </div>

                        <div class="worksheet-step" id="step-6">
                            <span class="step-number" id="step-num-6">6</span>
                            <span class="step-description">Less: Bank Charges & NSF</span>
                            <div class="step-input-group">
                                <input type="number" class="step-input" id="ws-charges" placeholder="0.00" step="0.01">
                                <span class="check-mark" id="check-6">‚úì</span>
                            </div>
                        </div>

                        <div class="worksheet-step" id="step-7">
                            <span class="step-number" id="step-num-7">7</span>
                            <span class="step-description">Adjusted Book Balance</span>
                            <div class="step-input-group">
                                <input type="number" class="step-input" id="ws-adj-book" placeholder="0.00" step="0.01">
                                <span class="check-mark" id="check-7">‚úì</span>
                            </div>
                        </div>

                        <div style="text-align: center; margin-top: var(--space-lg);">
                            <button class="btn btn-primary" onclick="validateReconciliation()">
                                ‚úì Validate Reconciliation
                            </button>
                            <button class="btn btn-outline" onclick="resetReconciliation()" style="margin-left: var(--space-md);">
                                ‚ü≥ Reset
                            </button>
                        </div>

                        <div id="reconciliation-feedback" class="feedback" style="margin-top: var(--space-lg);"></div>
                    </div>

                    <!-- Journal Entry Section -->
                    <div class="control-system-panel" style="margin-top: var(--space-xl);">
                        <h3 style="color: var(--primary); margin-bottom: var(--space-lg);">üìù Required Journal Entries</h3>
                        <p style="margin-bottom: var(--space-lg);">Based on the reconciliation, record the necessary adjusting entries:</p>
                        
                        <div style="background: var(--bg-light); padding: var(--space-lg); border-radius: var(--radius-lg);">
                            <div style="margin-bottom: var(--space-lg);">
                                <h4 style="margin-bottom: var(--space-md); color: var(--warning);">Entry 1: Bank Service Charge</h4>
                                <div class="journal-entries">
                                    <div class="journal-entry-row">
                                        <input type="text" placeholder="Account" id="je1-account" style="grid-column: span 2;">
                                        <input type="text" placeholder="Ref" style="width: 60px;">
                                        <input type="number" placeholder="Debit" id="je1-debit" step="0.01">
                                        <input type="number" placeholder="Credit" id="je1-credit" step="0.01" readonly>
                                    </div>
                                    <div class="journal-entry-row">
                                        <input type="text" value="Cash" readonly style="grid-column: span 2; background: var(--bg-light);">
                                        <input type="text" placeholder="Ref" style="width: 60px;">
                                        <input type="number" placeholder="Debit" step="0.01" readonly>
                                        <input type="number" placeholder="Credit" id="je1-cash-credit" step="0.01">
                                    </div>
                                </div>
                                <div style="text-align: center; margin-top: var(--space-md);">
                                    <button class="btn btn-secondary" onclick="checkEntry1()">Check Entry</button>
                                </div>
                                <div id="entry1-feedback" class="feedback" style="margin-top: var(--space-md);"></div>
                            </div>

                            <div>
                                <h4 style="margin-bottom: var(--space-md); color: var(--error);">Entry 2: NSF Check</h4>
                                <div class="journal-entries">
                                    <div class="journal-entry-row">
                                        <input type="text" placeholder="Account" id="je2-account" style="grid-column: span 2;">
                                        <input type="text" placeholder="Ref" style="width: 60px;">
                                        <input type="number" placeholder="Debit" id="je2-debit" step="0.01">
                                        <input type="number" placeholder="Credit" id="je2-credit" step="0.01" readonly>
                                    </div>
                                    <div class="journal-entry-row">
                                        <input type="text" value="Cash" readonly style="grid-column: span 2; background: var(--bg-light);">
                                        <input type="text" placeholder="Ref" style="width: 60px;">
                                        <input type="number" placeholder="Debit" step="0.01" readonly>
                                        <input type="number" placeholder="Credit" id="je2-cash-credit" step="0.01">
                                    </div>
                                </div>
                                <div style="text-align: center; margin-top: var(--space-md);">
                                    <button class="btn btn-secondary" onclick="checkEntry2()">Check Entry</button>
                                </div>
                                <div id="entry2-feedback" class="feedback" style="margin-top: var(--space-md);"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Module 2: Petty Cash Management -->
                <div id="module-petty" class="tab-content-section">
                    <h2 style="color: var(--primary); margin-bottom: var(--space-lg);">
                        Petty Cash Fund Manager (Imprest System)
                    </h2>

                    <div class="help-panel">
                        <h4>üìñ How the Imprest System Works</h4>
                        <ul>
                            <li><strong>Establish:</strong> Set up a fixed fund amount (e.g., $500)</li>
                            <li><strong>Disburse:</strong> Make small cash payments with proper documentation</li>
                            <li><strong>Replenish:</strong> Restore fund to original amount when low</li>
                            <li><strong>Audit:</strong> Verify receipts + cash = fund amount</li>
                        </ul>
                    </div>

                    <!-- Fund Dashboard -->
                    <div class="petty-cash-dashboard">
                        <div class="petty-cash-header">
                            <h3>üíº Summit Construction Petty Cash Fund</h3>
                            <div class="fund-status-badge" id="fund-status-badge">
                                <span>üü¢</span> Sufficient
                            </div>
                        </div>

                        <div class="fund-overview">
                            <div class="fund-card">
                                <label>Fund Amount (Fixed)</label>
                                <div class="value" id="fund-amount">$500.00</div>
                            </div>
                            <div class="fund-card">
                                <label>Current Cash</label>
                                <div class="value" id="current-cash">$500.00</div>
                            </div>
                            <div class="fund-card">
                                <label>Total Spent</label>
                                <div class="value" id="total-spent">$0.00</div>
                            </div>
                            <div class="fund-card">
                                <label>Custodian</label>
                                <div class="value" style="font-size: 1rem;">Mike Thompson</div>
                            </div>
                        </div>

                        <div style="background: rgba(255,255,255,0.1); padding: var(--space-md); border-radius: var(--radius-md); margin-top: var(--space-md);">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span>üßæ Receipts Total:</span>
                                <span id="receipts-total" style="font-weight: 700; font-family: monospace;">$0.00</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: var(--space-sm);">
                                <span>üíµ Cash on Hand:</span>
                                <span id="cash-on-hand" style="font-weight: 700; font-family: monospace;">$500.00</span>
                            </div>
                            <div style="border-top: 1px solid rgba(255,255,255,0.2); margin-top: var(--space-sm); padding-top: var(--space-sm); display: flex; justify-content: space-between; align-items: center;">
                                <span>üìä Verification (should = $500):</span>
                                <span id="verification-total" style="font-weight: 700; font-family: monospace; color: var(--secondary);">$500.00</span>
                            </div>
                        </div>
                    </div>

                    <!-- Transaction Form -->
                    <div class="transaction-panel">
                        <h3 style="color: var(--primary); margin-bottom: var(--space-lg);">Record New Disbursement</h3>
                        
                        <div class="transaction-form">
                            <div class="form-group">
                                <label>Date</label>
                                <input type="date" id="petty-date">
                            </div>
                            <div class="form-group">
                                <label>Category</label>
                                <select id="petty-category">
                                    <option value="">Select Category...</option>
                                    <option value="office">Office Supplies</option>
                                    <option value="postage">Postage & Delivery</option>
                                    <option value="travel">Travel & Transportation</option>
                                    <option value="meals">Meals & Entertainment</option>
                                    <option value="misc">Miscellaneous</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Payee/Vendor</label>
                                <input type="text" id="petty-vendor" placeholder="e.g., Office Depot">
                            </div>
                            <div class="form-group">
                                <label>Amount</label>
                                <input type="number" id="petty-amount" placeholder="0.00" step="0.01" min="0">
                            </div>
                            <div class="form-group">
                                <label>Description</label>
                                <input type="text" id="petty-desc" placeholder="Brief description">
                            </div>
                            <div class="form-group">
                                <label>&nbsp;</label>
                                <div class="receipt-checkbox">
                                    <input type="checkbox" id="petty-receipt" style="width: 20px; height: 20px;">
                                    <label for="petty-receipt" style="margin: 0; font-weight: normal;">Receipt Attached</label>
                                </div>
                            </div>
                        </div>

                        <div style="text-align: center;">
                            <button class="btn btn-primary" onclick="recordPettyTransaction()">
                                üíæ Record Disbursement
                            </button>
                        </div>

                        <div id="petty-feedback" class="feedback" style="margin-top: var(--space-lg);"></div>
                    </div>

                    <!-- Transaction History -->
                    <div class="transaction-history">
                        <h4 style="margin-bottom: var(--space-md); color: var(--primary);">üìã Transaction History</h4>
                        <div id="petty-transactions-list">
                            <p style="text-align: center; color: var(--text-muted); padding: var(--space-lg);">
                                No transactions recorded yet.
                            </p>
                        </div>
                    </div>

                    <!-- Cash Variance Calculator -->
                    <div class="variance-section">
                        <h3 style="color: var(--primary); margin-bottom: var(--space-lg);">üîç Cash Count Verification</h3>
                        <p style="margin-bottom: var(--space-lg);">At period end, count the actual cash and calculate any shortage or surplus:</p>

                        <div class="variance-calculator">
                            <div class="variance-card">
                                <h5>Fund Amount</h5>
                                <input type="number" id="var-fund" value="500.00" readonly>
                            </div>
                            <div class="variance-card">
                                <h5>Actual Cash Counted</h5>
                                <input type="number" id="var-actual" placeholder="0.00" step="0.01" onchange="calculateVariance()">
                            </div>
                            <div class="variance-card">
                                <h5>Receipts Total</h5>
                                <input type="number" id="var-receipts" value="0.00" readonly>
                            </div>
                        </div>

                        <div style="text-align: center; margin-top: var(--space-lg);">
                            <button class="btn btn-primary" onclick="verifyFund()">Verify Fund Balance</button>
                        </div>

                        <div id="variance-result" class="variance-result" style="display: none;"></div>
                    </div>

                    <!-- Replenishment Section -->
                    <div class="replenishment-alert" id="replenish-alert">
                        <h4>‚ö†Ô∏è Fund Replenishment Required</h4>
                        <p>Fund balance is low. Submit replenishment request to restore fund to $500.</p>
                        <div style="margin-top: var(--space-md);">
                            <strong>Amount to Replenish: </strong>
                            <span id="replenish-amount" style="font-size: 1.25rem; font-weight: 700; color: var(--warning);"></span>
                        </div>
                        <div style="text-align: center; margin-top: var(--space-lg);">
                            <button class="btn btn-success" onclick="replenishFund()">
                                üíµ Request Replenishment
                            </button>
                            <button class="btn btn-outline" onclick="hideReplenishAlert()" style="margin-left: var(--space-md);">
                                Cancel
                            </button>
                        </div>
                    </div>

                    <!-- Category Breakdown -->
                    <div class="control-system-panel" style="margin-top: var(--space-xl);">
                        <h3 style="color: var(--primary); margin-bottom: var(--space-lg);">üìä Expense Breakdown by Category</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-md);">
                            <div style="background: var(--bg-light); padding: var(--space-md); border-radius: var(--radius-md); text-align: center;">
                                <div style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: var(--space-xs);">Office Supplies</div>
                                <div style="font-size: 1.25rem; font-weight: 700; color: var(--primary);" id="cat-office">$0.00</div>
                            </div>
                            <div style="background: var(--bg-light); padding: var(--space-md); border-radius: var(--radius-md); text-align: center;">
                                <div style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: var(--space-xs);">Postage</div>
                                <div style="font-size: 1.25rem; font-weight: 700; color: var(--primary);" id="cat-postage">$0.00</div>
                            </div>
                            <div style="background: var(--bg-light); padding: var(--space-md); border-radius: var(--radius-md); text-align: center;">
                                <div style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: var(--space-xs);">Travel</div>
                                <div style="font-size: 1.25rem; font-weight: 700; color: var(--primary);" id="cat-travel">$0.00</div>
                            </div>
                            <div style="background: var(--bg-light); padding: var(--space-md); border-radius: var(--radius-md); text-align: center;">
                                <div style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: var(--space-xs);">Meals</div>
                                <div style="font-size: 1.25rem; font-weight: 700; color: var(--primary);" id="cat-meals">$0.00</div>
                            </div>
                            <div style="background: var(--bg-light); padding: var(--space-md); border-radius: var(--radius-md); text-align: center;">
                                <div style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: var(--space-xs);">Miscellaneous</div>
                                <div style="font-size: 1.25rem; font-weight: 700; color: var(--primary);" id="cat-misc">$0.00</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Module 3: Internal Controls -->
                <div id="module-control" class="tab-content-section">
                    <h2 style="color: var(--primary); margin-bottom: var(--space-lg);">
                        Internal Controls & Segregation of Duties
                    </h2>

                    <div class="help-panel">
                        <h4>üéØ Key Principles of Internal Control</h4>
                        <ul>
                            <li><strong>Segregation of Duties:</strong> Separate authorization, recording, and custody</li>
                            <li><strong>Authorization:</strong> Proper approval before transactions</li>
                            <li><strong>Documentation:</strong> Maintain adequate records</li>
                            <li><strong>Independent Verification:</strong> Regular reviews and reconciliations</li>
                        </ul>
                    </div>

                    <!-- Scenario 1: Approval Workflow -->
                    <div class="control-system-panel">
                        <h3 style="color: var(--primary); margin-bottom: var(--space-lg);">üîÑ Approval Workflow Simulation</h3>
                        
                        <div class="control-flow-diagram">
                            <div class="control-stage active" id="stage-request">
                                <div class="stage-icon">üìù</div>
                                <div class="stage-title">Request</div>
                                <div class="stage-desc">Employee submits request</div>
                            </div>
                            <div class="control-stage" id="stage-review">
                                <div class="stage-icon">üëÅÔ∏è</div>
                                <div class="stage-title">Review</div>
                                <div class="stage-desc">Manager reviews request</div>
                            </div>
                            <div class="control-stage" id="stage-approve">
                                <div class="stage-icon">‚úÖ</div>
                                <div class="stage-title">Approve</div>
                                <div class="stage-desc">Authorization granted</div>
                            </div>
                            <div class="control-stage" id="stage-execute">
                                <div class="stage-icon">üíº</div>
                                <div class="stage-title">Execute</div>
                                <div class="stage-desc">Transaction processed</div>
                            </div>
                            <div class="control-stage" id="stage-record">
                                <div class="stage-icon">üìö</div>
                                <div class="stage-title">Record</div>
                                <div class="stage-desc">Entry recorded in books</div>
                            </div>
                        </div>

                        <div class="approval-workflow">
                            <div class="workflow-header">
                                <h4 style="color: var(--primary);">Scenario Analysis</h4>
                                <span id="scenario-counter" style="color: var(--text-muted);">Scenario 1 of 3</span>
                            </div>

                            <div class="scenario-card" id="scenario-1">
                                <div class="scenario-header">
                                    <span class="scenario-title">Scenario 1: Unauthorized Purchase</span>
                                    <span class="risk-level high">High Risk</span>
                                </div>
                                <p style="margin-bottom: var(--space-lg);">
                                    A project manager orders $5,000 worth of construction materials without getting prior approval from the department head. The manager also handles receiving the goods and authorizes payment.
                                </p>
                                <div class="control-options">
                                    <div class="control-option" onclick="selectOption(this, false)">
                                        <h5>No Action Needed</h5>
                                        <p>The project manager has authority to make such purchases.</p>
                                    </div>
                                    <div class="control-option" onclick="selectOption(this, true)">
                                        <h5>Violation of Segregation</h5>
                                        <p>One person should not authorize, receive, and pay for the same transaction.</p>
                                    </div>
                                    <div class="control-option" onclick="selectOption(this, false)">
                                        <h5>Documentation Issue Only</h5>
                                        <p>Just need to get the paperwork approved retroactively.</p>
                                    </div>
                                </div>
                            </div>

                            <div class="scenario-card" id="scenario-2" style="display: none;">
                                <div class="scenario-header">
                                    <span class="scenario-title">Scenario 2: Check Signing</span>
                                    <span class="risk-level medium">Medium Risk</span>
                                </div>
                                <p style="margin-bottom: var(--space-lg);">
                                    The accounts payable clerk prepares all checks for vendor payments. The CFO reviews and signs the checks. However, the clerk also reconciles the bank statement monthly.
                                </p>
                                <div class="control-options">
                                    <div class="control-option" onclick="selectOption(this, false)">
                                        <h5>Proper Control</h5>
                                        <p>The CFO's signature provides adequate control over the process.</p>
                                    </div>
                                    <div class="control-option" onclick="selectOption(this, true)">
                                        <h5>Control Weakness</h5>
                                        <p>The same person who prepares checks should not reconcile the bank statement.</p>
                                    </div>
                                    <div class="control-option" onclick="selectOption(this, false)">
                                        <h5>Need More Signatures</h5>
                                        <p>Require two signatures on all checks for better control.</p>
                                    </div>
                                </div>
                            </div>

                            <div class="scenario-card" id="scenario-3" style="display: none;">
                                <div class="scenario-header">
                                    <span class="scenario-title">Scenario 3: Inventory Management</span>
                                    <span class="risk-level high">High Risk</span>
                                </div>
                                <p style="margin-bottom: var(--space-lg);">
                                    The warehouse supervisor counts inventory, records the counts in the system, investigates discrepancies, and adjusts inventory records when needed.
                                </p>
                                <div class="control-options">
                                    <div class="control-option" onclick="selectOption(this, false)">
                                        <h5>Efficient Process</h5>
                                        <p>Having one person handle all inventory tasks is efficient.</p>
                                    </div>
                                    <div class="control-option" onclick="selectOption(this, true)">
                                        <h5>Segregation Violation</h5>
                                        <p>The person who counts should not also record and adjust without independent verification.</p>
                                    </div>
                                    <div class="control-option" onclick="selectOption(this, false)">
                                        <h5>Need More Staff</h5>
                                        <p>Just need to hire more warehouse workers.</p>
                                    </div>
                                </div>
                            </div>

                            <div style="text-align: center; margin-top: var(--space-lg);">
                                <button class="btn btn-outline" onclick="prevScenario()" id="btn-prev-scenario" style="display: none;">‚Üê Previous</button>
                                <button class="btn btn-primary" onclick="nextScenario()" id="btn-next-scenario">Next Scenario ‚Üí</button>
                            </div>

                            <div id="scenario-feedback" class="feedback" style="margin-top: var(--space-lg);"></div>
                        </div>
                    </div>

                    <!-- Scenario 2: Error Detection -->
                    <div class="error-detection-panel">
                        <h3 style="color: var(--primary); margin-bottom: var(--space-lg);">üîç Error Detection Exercise</h3>
                        <p style="margin-bottom: var(--space-lg);">Compare the receiving report with the vendor invoice and identify all discrepancies:</p>

                        <div class="document-comparison">
                            <div class="document-panel">
                                <h4>üì¶ Receiving Report #8472</h4>
                                <div class="document-item">
                                    <span>Steel Beams - 10ft</span>
                                    <span>Qty: 20</span>
                                </div>
                                <div class="document-item">
                                    <span>Concrete Mix - 50lb</span>
                                    <span>Qty: 50</span>
                                </div>
                                <div class="document-item">
                                    <span>Nails - 5lb box</span>
                                    <span>Qty: 10</span>
                                </div>
                                <div class="document-item">
                                    <span>Safety Helmets</span>
                                    <span>Qty: 15</span>
                                </div>
                                <div style="margin-top: var(--space-md); padding-top: var(--space-md); border-top: 2px solid var(--primary); text-align: right;">
                                    <strong>Date: Jan 15, 2026</strong>
                                </div>
                            </div>

                            <div class="document-panel">
                                <h4>üìÑ Vendor Invoice #INV-4521</h4>
                                <div class="document-item">
                                    <span>Steel Beams - 10ft</span>
                                    <span>Qty: 25</span>
                                </div>
                                <div class="document-item">
                                    <span>Concrete Mix - 50lb</span>
                                    <span>Qty: 50</span>
                                </div>
                                <div class="document-item">
                                    <span>Nails - 5lb box</span>
                                    <span>Qty: 12</span>
                                </div>
                                <div class="document-item">
                                    <span>Safety Helmets</span>
                                    <span>Qty: 15</span>
                                </div>
                                <div style="margin-top: var(--space-md); padding-top: var(--space-md); border-top: 2px solid var(--primary); text-align: right;">
                                    <strong>Date: Jan 14, 2026</strong>
                                </div>
                            </div>
                        </div>

                        <div class="error-indicators">
                            <h4 style="margin: var(--space-lg) 0 var(--space-md); color: var(--primary);">Identify the Discrepancies:</h4>
                            
                            <div class="error-item" onclick="toggleError(this, true)">
                                <input type="checkbox" class="error-checkbox" readonly>
                                <div class="error-description">
                                    <strong>Quantity Mismatch - Steel Beams</strong>
                                    <span>Invoice shows 25, but receiving report shows 20</span>
                                </div>
                            </div>

                            <div class="error-item" onclick="toggleError(this, false)">
                                <input type="checkbox" class="error-checkbox" readonly>
                                <div class="error-description">
                                    <strong>Wrong Product - Nails</strong>
                                    <span>Different type of nails were ordered</span>
                                </div>
                            </div>

                            <div class="error-item" onclick="toggleError(this, true)">
                                <input type="checkbox" class="error-checkbox" readonly>
                                <div class="error-description">
                                    <strong>Quantity Mismatch - Nails</strong>
                                    <span>Invoice shows 12 boxes, but receiving report shows 10</span>
                                </div>
                            </div>

                            <div class="error-item" onclick="toggleError(this, true)">
                                <input type="checkbox" class="error-checkbox" readonly>
                                <div class="error-description">
                                    <strong>Date Discrepancy</strong>
                                    <span>Invoice dated Jan 14, receiving report dated Jan 15</span>
                                </div>
                            </div>

                            <div class="error-item" onclick="toggleError(this, false)">
                                <input type="checkbox" class="error-checkbox" readonly>
                                <div class="error-description">
                                    <strong>Missing Safety Equipment</strong>
                                    <span>Work gloves were not received</span>
                                </div>
                            </div>

                            <div style="text-align: center; margin-top: var(--space-lg);">
                                <button class="btn btn-primary" onclick="checkErrors()">Check Answers</button>
                                <button class="btn btn-outline" onclick="resetErrors()" style="margin-left: var(--space-md);">Reset</button>
                            </div>

                            <div id="error-feedback" class="feedback" style="margin-top: var(--space-lg);"></div>
                        </div>
                    </div>

                    <!-- Scenario 3: Segregation of Duties Game -->
                    <div class="segregation-game">
                        <h3 style="color: var(--primary); margin-bottom: var(--space-lg);">üéÆ Segregation of Duties - Task Assignment</h3>
                        <p style="margin-bottom: var(--space-lg);">
                            Assign the following tasks to Employee A and Employee B to ensure proper segregation of duties. 
                            <strong>Rule:</strong> The same person should not handle both physical custody and recording for the same asset.
                        </p>

                        <div class="game-board">
                            <div class="employee-card">
                                <h4>üë§ Employee A</h4>
                                <div class="task-pool" id="pool-a" ondrop="drop(event, 'a')" ondragover="allowDrop(event)">
                                    <p style="text-align: center; color: var(--text-muted); font-size: 0.9rem;">Drop tasks here</p>
                                </div>
                            </div>

                            <div style="display: flex; flex-direction: column; gap: var(--space-sm);">
                                <div class="task-item" draggable="true" ondragstart="drag(event)" data-task="cash-custody" id="task-cash-custody">
                                    üíµ Handle Cash Receipts
                                </div>
                                <div class="task-item" draggable="true" ondragstart="drag(event)" data-task="cash-record" id="task-cash-record">
                                    üìù Record Cash Transactions
                                </div>
                                <div class="task-item" draggable="true" ondragstart="drag(event)" data-task="inv-custody" id="task-inv-custody">
                                    üì¶ Manage Inventory
                                </div>
                                <div class="task-item" draggable="true" ondragstart="drag(event)" data-task="inv-record" id="task-inv-record">
                                    üìä Record Inventory Changes
                                </div>
                                <div class="task-item" draggable="true" ondragstart="drag(event)" data-task="approve" id="task-approve">
                                    ‚úÖ Authorize Purchases
                                </div>
                                <div class="task-item" draggable="true" ondragstart="drag(event)" data-task="reconcile" id="task-reconcile">
                                    üîç Reconcile Bank Statement
                                </div>
                            </div>

                            <div class="employee-card">
                                <h4>üë§ Employee B</h4>
                                <div class="task-pool" id="pool-b" ondrop="drop(event, 'b')" ondragover="allowDrop(event)">
                                    <p style="text-align: center; color: var(--text-muted); font-size: 0.9rem;">Drop tasks here</p>
                                </div>
                            </div>
                        </div>

                        <div class="conflict-alert" id="conflict-alert">
                            <strong>‚ö†Ô∏è Segregation Violation!</strong>
                            <p id="conflict-message"></p>
                        </div>

                        <div style="text-align: center; margin-top: var(--space-lg);">
                            <button class="btn btn-primary" onclick="validateSegregation()">Validate Assignment</button>
                            <button class="btn btn-outline" onclick="resetSegregation()" style="margin-left: var(--space-md);">Reset</button>
                        </div>

                        <div id="segregation-feedback" class="feedback" style="margin-top: var(--space-lg);"></div>
                    </div>
                </div>

                <!-- Summary Dashboard -->
                <div class="dashboard-summary">
                    <div class="summary-card">
                        <h4>Bank Reconciliation Status</h4>
                        <div class="value" id="summary-bank">Pending</div>
                    </div>
                    <div class="summary-card">
                        <h4>Petty Cash Balance</h4>
                        <div class="value" id="summary-petty">$500</div>
                    </div>
                    <div class="summary-card">
                        <h4>Control Violations</h4>
                        <div class="value" id="summary-controls">0</div>
                    </div>
                </div>
            </section>

            <nav class="page-nav">
                <a href="ch08.html" class="btn btn-prev">‚Üê Back to Chapter</a>
                <a href="ch08_PRACTICE.html" class="btn btn-primary">Practice Case ‚Üí</a>
            </nav>
        </article>
    </main>

    <footer>
        <div class="container">
            <p>Accounting Principles | Chapter 8 | Internal Control and Cash Management</p>
        </div>
    </footer>

    <script src="../../components.js"></script>
    <script>
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // GLOBAL STATE MANAGEMENT
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        let currentModule = 'bank';
        let currentScenario = 1;
        let totalScenarios = 3;

        // Bank Reconciliation State
        const bankRecState = {
            bankBalance: 49825,
            depositsInTransit: 3200,
            outstandingChecks: 2750,
            bookBalance: 52275,
            bankCharges: 25,
            nsfCheck: 450
        };

        // Petty Cash State
        let pettyCashState = {
            fundAmount: 500.00,
            currentBalance: 500.00,
            transactions: [],
            categoryTotals: {
                office: 0,
                postage: 0,
                travel: 0,
                meals: 0,
                misc: 0
            }
        };

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // MODULE SWITCHING
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        function switchModule(module) {
            currentModule = module;
            
            // Update tabs
            document.querySelectorAll('.control-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`.control-tab[onclick="switchModule('${module}')"]`).classList.add('active');
            
            // Update content
            document.querySelectorAll('.tab-content-section').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`module-${module}`).classList.add('active');
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // BANK RECONCILIATION FUNCTIONS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        function validateReconciliation() {
            let allCorrect = true;
            const tolerance = 0.01;

            // Step 1: Bank Balance
            const step1 = parseFloat(document.getElementById('ws-bank-balance').value) || 0;
            if (Math.abs(step1 - bankRecState.bankBalance) < tolerance) {
                document.getElementById('step-1').classList.add('completed');
                document.getElementById('step-num-1').classList.add('completed');
                document.getElementById('check-1').classList.add('show');
            } else {
                allCorrect = false;
                showFeedback('reconciliation-feedback', `Step 1 is incorrect. Bank balance should be $${bankRecState.bankBalance.toLocaleString()}.`, false);
                return;
            }

            // Step 2: Deposits in Transit
            const step2 = parseFloat(document.getElementById('ws-deposits').value) || 0;
            if (Math.abs(step2 - bankRecState.depositsInTransit) < tolerance) {
                document.getElementById('step-2').classList.add('completed');
                document.getElementById('step-num-2').classList.add('completed');
                document.getElementById('check-2').classList.add('show');
            } else {
                allCorrect = false;
                showFeedback('reconciliation-feedback', `Step 2 is incorrect. Deposits in transit should be $${bankRecState.depositsInTransit.toLocaleString()}.`, false);
                return;
            }

            // Step 3: Outstanding Checks
            const step3 = parseFloat(document.getElementById('ws-checks').value) || 0;
            if (Math.abs(step3 - bankRecState.outstandingChecks) < tolerance) {
                document.getElementById('step-3').classList.add('completed');
                document.getElementById('step-num-3').classList.add('completed');
                document.getElementById('check-3').classList.add('show');
            } else {
                allCorrect = false;
                showFeedback('reconciliation-feedback', `Step 3 is incorrect. Outstanding checks should be $${bankRecState.outstandingChecks.toLocaleString()}.`, false);
                return;
            }

            // Step 4: Adjusted Bank Balance
            const expectedAdjBank = bankRecState.bankBalance + bankRecState.depositsInTransit - bankRecState.outstandingChecks;
            const step4 = parseFloat(document.getElementById('ws-adj-bank').value) || 0;
            if (Math.abs(step4 - expectedAdjBank) < tolerance) {
                document.getElementById('step-4').classList.add('completed');
                document.getElementById('step-num-4').classList.add('completed');
                document.getElementById('check-4').classList.add('show');
            } else {
                allCorrect = false;
                showFeedback('reconciliation-feedback', `Step 4 is incorrect. Adjusted bank balance should be $${expectedAdjBank.toLocaleString()}.`, false);
                return;
            }

            // Step 5: Book Balance
            const step5 = parseFloat(document.getElementById('ws-book-balance').value) || 0;
            if (Math.abs(step5 - bankRecState.bookBalance) < tolerance) {
                document.getElementById('step-5').classList.add('completed');
                document.getElementById('step-num-5').classList.add('completed');
                document.getElementById('check-5').classList.add('show');
            } else {
                allCorrect = false;
                showFeedback('reconciliation-feedback', `Step 5 is incorrect. Book balance should be $${bankRecState.bookBalance.toLocaleString()}.`, false);
                return;
            }

            // Step 6: Bank Charges & NSF
            const expectedCharges = bankRecState.bankCharges + bankRecState.nsfCheck;
            const step6 = parseFloat(document.getElementById('ws-charges').value) || 0;
            if (Math.abs(step6 - expectedCharges) < tolerance) {
                document.getElementById('step-6').classList.add('completed');
                document.getElementById('step-num-6').classList.add('completed');
                document.getElementById('check-6').classList.add('show');
            } else {
                allCorrect = false;
                showFeedback('reconciliation-feedback', `Step 6 is incorrect. Total charges should be $${expectedCharges.toLocaleString()}.`, false);
                return;
            }

            // Step 7: Adjusted Book Balance
            const expectedAdjBook = bankRecState.bookBalance - expectedCharges;
            const step7 = parseFloat(document.getElementById('ws-adj-book').value) || 0;
            if (Math.abs(step7 - expectedAdjBook) < tolerance) {
                document.getElementById('step-7').classList.add('completed');
                document.getElementById('step-num-7').classList.add('completed');
                document.getElementById('check-7').classList.add('show');
            } else {
                allCorrect = false;
                showFeedback('reconciliation-feedback', `Step 7 is incorrect. Adjusted book balance should be $${expectedAdjBook.toLocaleString()}.`, false);
                return;
            }

            // Check if both sides match
            if (Math.abs(expectedAdjBank - expectedAdjBook) < tolerance) {
                // Update company records display
                document.getElementById('adj-service-row').style.display = 'flex';
                document.getElementById('adj-nsf-row').style.display = 'flex';
                document.getElementById('adjusted-book-row').style.display = 'flex';
                
                showFeedback('reconciliation-feedback', 'üéâ Excellent! Reconciliation complete. Both sides match at $' + expectedAdjBank.toLocaleString() + '.', true);
                document.getElementById('summary-bank').textContent = '‚úì Complete';
            } else {
                showFeedback('reconciliation-feedback', 'The adjusted balances do not match. Please check your calculations.', false);
            }
        }

        function resetReconciliation() {
            // Clear all inputs
            for (let i = 1; i <= 7; i++) {
                document.getElementById(`ws-${['bank-balance', 'deposits', 'checks', 'adj-bank', 'book-balance', 'charges', 'adj-book'][i-1]}`).value = '';
                document.getElementById(`step-${i}`).classList.remove('completed');
                document.getElementById(`step-num-${i}`).classList.remove('completed');
                document.getElementById(`check-${i}`).classList.remove('show');
            }
            
            // Hide adjusted displays
            document.getElementById('adj-service-row').style.display = 'none';
            document.getElementById('adj-nsf-row').style.display = 'none';
            document.getElementById('adjusted-book-row').style.display = 'none';
            
            hideFeedback('reconciliation-feedback');
        }

        function checkEntry1() {
            const account = document.getElementById('je1-account').value.toLowerCase().trim();
            const debit = parseFloat(document.getElementById('je1-debit').value) || 0;
            const credit = parseFloat(document.getElementById('je1-cash-credit').value) || 0;

            const isCorrect = (account.includes('bank charge') || account.includes('service charge') || account.includes('expense')) 
                && Math.abs(debit - 25) < 0.01 
                && Math.abs(credit - 25) < 0.01;

            if (isCorrect) {
                showFeedback('entry1-feedback', '‚úì Correct! Bank service charge expense is debited and cash is credited.', true);
            } else {
                showFeedback('entry1-feedback', '‚úó Incorrect. Debit Bank Service Charge Expense for $25 and credit Cash for $25.', false);
            }
        }

        function checkEntry2() {
            const account = document.getElementById('je2-account').value.toLowerCase().trim();
            const debit = parseFloat(document.getElementById('je2-debit').value) || 0;
            const credit = parseFloat(document.getElementById('je2-cash-credit').value) || 0;

            const isCorrect = (account.includes('accounts receivable') || account.includes('a/r') || account.includes('receivable')) 
                && Math.abs(debit - 450) < 0.01 
                && Math.abs(credit - 450) < 0.01;

            if (isCorrect) {
                showFeedback('entry2-feedback', '‚úì Correct! Accounts Receivable is debited (to re-establish the receivable) and Cash is credited.', true);
            } else {
                showFeedback('entry2-feedback', '‚úó Incorrect. Debit Accounts Receivable for $450 and credit Cash for $450.', false);
            }
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // PETTY CASH FUNCTIONS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        function recordPettyTransaction() {
            const date = document.getElementById('petty-date').value;
            const category = document.getElementById('petty-category').value;
            const vendor = document.getElementById('petty-vendor').value.trim();
            const amount = parseFloat(document.getElementById('petty-amount').value) || 0;
            const description = document.getElementById('petty-desc').value.trim();
            const hasReceipt = document.getElementById('petty-receipt').checked;

            // Validation
            if (!date || !category || !vendor || amount <= 0) {
                showFeedback('petty-feedback', 'Please fill in all required fields (Date, Category, Vendor, Amount).', false);
                return;
            }

            if (amount > pettyCashState.currentBalance) {
                showFeedback('petty-feedback', `Insufficient funds. Current balance is $${pettyCashState.currentBalance.toFixed(2)}`, false);
                return;
            }

            if (!hasReceipt && amount > 25) {
                if (!confirm('‚ö†Ô∏è Warning: Amount exceeds $25 without receipt. Continue anyway?')) {
                    return;
                }
            }

            // Create transaction
            const transaction = {
                id: Date.now(),
                date,
                category,
                vendor,
                amount,
                description,
                hasReceipt
            };

            // Update state
            pettyCashState.transactions.push(transaction);
            pettyCashState.currentBalance -= amount;
            pettyCashState.categoryTotals[category] += amount;

            // Update UI
            updatePettyCashUI();
            clearPettyForm();
            
            showFeedback('petty-feedback', `‚úì Transaction recorded: $${amount.toFixed(2)} for ${getCategoryName(category)}`, true);

            // Check if replenishment needed
            if (pettyCashState.currentBalance < 100) {
                showReplenishAlert();
            }
        }

        function updatePettyCashUI() {
            // Update fund cards
            const totalSpent = pettyCashState.transactions.reduce((sum, t) => sum + t.amount, 0);
            document.getElementById('current-cash').textContent = `$${pettyCashState.currentBalance.toFixed(2)}`;
            document.getElementById('total-spent').textContent = `$${totalSpent.toFixed(2)}`;
            document.getElementById('summary-petty').textContent = `$${pettyCashState.currentBalance.toFixed(0)}`;

            // Update receipts and verification
            document.getElementById('receipts-total').textContent = `$${totalSpent.toFixed(2)}`;
            document.getElementById('cash-on-hand').textContent = `$${pettyCashState.currentBalance.toFixed(2)}`;
            document.getElementById('var-receipts').value = totalSpent.toFixed(2);
            document.getElementById('verification-total').textContent = `$${(totalSpent + pettyCashState.currentBalance).toFixed(2)}`;

            // Update status badge
            const badge = document.getElementById('fund-status-badge');
            if (pettyCashState.currentBalance >= 200) {
                badge.className = 'fund-status-badge';
                badge.innerHTML = '<span>üü¢</span> Sufficient';
            } else if (pettyCashState.currentBalance >= 100) {
                badge.className = 'fund-status-badge low';
                badge.innerHTML = '<span>üü°</span> Low';
            } else {
                badge.className = 'fund-status-badge critical';
                badge.innerHTML = '<span>üî¥</span> Critical';
            }

            // Update transaction list
            const listContainer = document.getElementById('petty-transactions-list');
            if (pettyCashState.transactions.length === 0) {
                listContainer.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: var(--space-lg);">No transactions recorded yet.</p>';
            } else {
                listContainer.innerHTML = pettyCashState.transactions.slice().reverse().map(tx => `
                    <div class="transaction-item ${tx.hasReceipt ? 'valid-receipt' : 'no-receipt'}">
                        <span class="tx-date">${formatDate(tx.date)}</span>
                        <div class="tx-details">
                            <span class="tx-desc">${getCategoryName(tx.category)}</span>
                            <span class="tx-vendor">${tx.vendor}${tx.description ? ' - ' + tx.description : ''}</span>
                        </div>
                        <span class="tx-amount">-$${tx.amount.toFixed(2)}</span>
                        <span>${getCategoryBadge(tx.category)}</span>
                        <span class="tx-receipt-icon">${tx.hasReceipt ? 'üìé' : '‚ö†Ô∏è'}</span>
                    </div>
                `).join('');
            }

            // Update category breakdown
            document.getElementById('cat-office').textContent = `$${pettyCashState.categoryTotals.office.toFixed(2)}`;
            document.getElementById('cat-postage').textContent = `$${pettyCashState.categoryTotals.postage.toFixed(2)}`;
            document.getElementById('cat-travel').textContent = `$${pettyCashState.categoryTotals.travel.toFixed(2)}`;
            document.getElementById('cat-meals').textContent = `$${pettyCashState.categoryTotals.meals.toFixed(2)}`;
            document.getElementById('cat-misc').textContent = `$${pettyCashState.categoryTotals.misc.toFixed(2)}`;
        }

        function clearPettyForm() {
            document.getElementById('petty-date').value = '';
            document.getElementById('petty-category').value = '';
            document.getElementById('petty-vendor').value = '';
            document.getElementById('petty-amount').value = '';
            document.getElementById('petty-desc').value = '';
            document.getElementById('petty-receipt').checked = false;
        }

        function getCategoryName(category) {
            const names = {
                office: 'Office Supplies',
                postage: 'Postage & Delivery',
                travel: 'Travel & Transportation',
                meals: 'Meals & Entertainment',
                misc: 'Miscellaneous'
            };
            return names[category] || category;
        }

        function getCategoryBadge(category) {
            const badges = {
                office: '<span class="category-badge office">Office</span>',
                postage: '<span class="category-badge postage">Postage</span>',
                travel: '<span class="category-badge transport">Travel</span>',
                meals: '<span class="category-badge repairs">Meals</span>',
                misc: '<span class="category-badge">Misc</span>'
            };
            return badges[category] || '';
        }

        function formatDate(dateStr) {
            if (!dateStr) return '';
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        }

        function calculateVariance() {
            const fundAmount = parseFloat(document.getElementById('var-fund').value) || 0;
            const actualCash = parseFloat(document.getElementById('var-actual').value) || 0;
            const receiptsTotal = parseFloat(document.getElementById('var-receipts').value) || 0;
            
            const expectedCash = fundAmount - receiptsTotal;
            const variance = actualCash - expectedCash;
            
            return { variance, expectedCash };
        }

        function verifyFund() {
            const { variance } = calculateVariance();
            const resultDiv = document.getElementById('variance-result');
            
            resultDiv.style.display = 'block';
            
            if (Math.abs(variance) < 0.01) {
                resultDiv.className = 'variance-result balanced';
                resultDiv.innerHTML = `
                    <strong>‚úì Fund is Balanced</strong><br>
                    Cash + Receipts = Fund Amount<br>
                    No shortage or overage detected.
                `;
            } else if (variance < 0) {
                resultDiv.className = 'variance-result short';
                resultDiv.innerHTML = `
                    <strong>‚ö†Ô∏è Cash Shortage Detected</strong><br>
                    Shortage Amount: $${Math.abs(variance).toFixed(2)}<br>
                    <small>Debit: Cash Shortage Expense | Credit: Petty Cash</small>
                `;
            } else {
                resultDiv.className = 'variance-result over';
                resultDiv.innerHTML = `
                    <strong>‚ö†Ô∏è Cash Overage Detected</strong><br>
                    Overage Amount: $${variance.toFixed(2)}<br>
                    <small>Debit: Petty Cash | Credit: Cash Overage Revenue</small>
                `;
            }
        }

        function showReplenishAlert() {
            const replenishAmount = pettyCashState.fundAmount - pettyCashState.currentBalance;
            document.getElementById('replenish-amount').textContent = `$${replenishAmount.toFixed(2)}`;
            document.getElementById('replenish-alert').classList.add('show');
        }

        function hideReplenishAlert() {
            document.getElementById('replenish-alert').classList.remove('show');
        }

        function replenishFund() {
            const replenishAmount = pettyCashState.fundAmount - pettyCashState.currentBalance;
            
            // Add replenishment transaction
            pettyCashState.transactions.push({
                id: Date.now(),
                date: new Date().toISOString().split('T')[0],
                category: 'misc',
                vendor: 'Replenishment',
                amount: replenishAmount,
                description: 'Fund replenished to $500',
                hasReceipt: true
            });
            
            // Reset fund
            pettyCashState.currentBalance = pettyCashState.fundAmount;
            
            // Reset category totals for new period
            Object.keys(pettyCashState.categoryTotals).forEach(key => {
                pettyCashState.categoryTotals[key] = 0;
            });
            
            updatePettyCashUI();
            hideReplenishAlert();
            showFeedback('petty-feedback', `‚úì Fund replenished with $${replenishAmount.toFixed(2)}. Fund restored to $500.`, true);
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // INTERNAL CONTROL FUNCTIONS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        function selectOption(element, isCorrect) {
            // Remove selected class from siblings
            const parent = element.parentElement;
            parent.querySelectorAll('.control-option').forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });
            
            // Add appropriate class
            element.classList.add('selected');
            element.classList.add(isCorrect ? 'correct' : 'incorrect');
            
            // Show feedback
            const feedbackDiv = document.getElementById('scenario-feedback');
            if (isCorrect) {
                showFeedback('scenario-feedback', '‚úì Correct! This represents a proper understanding of internal controls.', true);
                updateControlStages();
            } else {
                showFeedback('scenario-feedback', '‚úó Not quite. Think about the principles of segregation of duties and authorization.', false);
            }
        }

        function updateControlStages() {
            const stages = ['stage-request', 'stage-review', 'stage-approve', 'stage-execute', 'stage-record'];
            const currentStageIndex = Math.min(currentScenario, stages.length - 1);
            
            for (let i = 0; i <= currentStageIndex; i++) {
                document.getElementById(stages[i]).classList.add('completed');
                document.getElementById(stages[i]).classList.remove('active');
            }
            
            if (currentStageIndex < stages.length - 1) {
                document.getElementById(stages[currentStageIndex + 1]).classList.add('active');
            }
        }

        function nextScenario() {
            if (currentScenario < totalScenarios) {
                document.getElementById(`scenario-${currentScenario}`).style.display = 'none';
                currentScenario++;
                document.getElementById(`scenario-${currentScenario}`).style.display = 'block';
                document.getElementById('scenario-counter').textContent = `Scenario ${currentScenario} of ${totalScenarios}`;
                
                document.getElementById('btn-prev-scenario').style.display = 'inline-block';
                
                if (currentScenario === totalScenarios) {
                    document.getElementById('btn-next-scenario').textContent = 'Finish';
                }
                
                hideFeedback('scenario-feedback');
            } else {
                showFeedback('scenario-feedback', 'üéâ Congratulations! You have completed all scenarios.', true);
            }
        }

        function prevScenario() {
            if (currentScenario > 1) {
                document.getElementById(`scenario-${currentScenario}`).style.display = 'none';
                currentScenario--;
                document.getElementById(`scenario-${currentScenario}`).style.display = 'block';
                document.getElementById('scenario-counter').textContent = `Scenario ${currentScenario} of ${totalScenarios}`;
                
                if (currentScenario === 1) {
                    document.getElementById('btn-prev-scenario').style.display = 'none';
                }
                
                document.getElementById('btn-next-scenario').textContent = 'Next Scenario ‚Üí';
                hideFeedback('scenario-feedback');
            }
        }

        // Error Detection Functions
        let foundErrors = new Set();

        function toggleError(element, isError) {
            const checkbox = element.querySelector('.error-checkbox');
            checkbox.checked = !checkbox.checked;
            
            if (checkbox.checked) {
                element.classList.add('found');
                if (isError) {
                    foundErrors.add(element);
                }
            } else {
                element.classList.remove('found');
                foundErrors.delete(element);
            }
        }

        function checkErrors() {
            const correctErrors = document.querySelectorAll('.error-item:nth-child(1), .error-item:nth-child(3), .error-item:nth-child(4)');
            let correctCount = 0;
            
            correctErrors.forEach(error => {
                if (error.classList.contains('found')) {
                    correctCount++;
                }
            });
            
            const incorrectSelected = document.querySelectorAll('.error-item:nth-child(2).found, .error-item:nth-child(5).found').length;
            
            if (correctCount === 3 && incorrectSelected === 0) {
                showFeedback('error-feedback', 'üéâ Excellent! You identified all three discrepancies correctly.', true);
            } else if (correctCount > 0) {
                showFeedback('error-feedback', `You found ${correctCount} out of 3 discrepancies. Keep looking!`, false);
            } else {
                showFeedback('error-feedback', 'Keep looking! Compare quantities and dates carefully.', false);
            }
        }

        function resetErrors() {
            document.querySelectorAll('.error-item').forEach(item => {
                item.classList.remove('found');
                item.querySelector('.error-checkbox').checked = false;
            });
            foundErrors.clear();
            hideFeedback('error-feedback');
        }

        // Drag and Drop for Segregation Game
        let draggedElement = null;

        function drag(ev) {
            draggedElement = ev.target;
            ev.target.classList.add('dragging');
            ev.dataTransfer.setData('text', ev.target.id);
        }

        function allowDrop(ev) {
            ev.preventDefault();
        }

        function drop(ev, pool) {
            ev.preventDefault();
            if (draggedElement) {
                draggedElement.classList.remove('dragging');
                const poolElement = document.getElementById(`pool-${pool}`);
                poolElement.appendChild(draggedElement);
                
                // Clear the placeholder text
                const placeholder = poolElement.querySelector('p');
                if (placeholder) {
                    placeholder.style.display = 'none';
                }
                
                checkConflicts();
            }
        }

        function checkConflicts() {
            const poolA = document.getElementById('pool-a');
            const poolB = document.getElementById('pool-b');
            
            const tasksA = Array.from(poolA.querySelectorAll('.task-item')).map(t => t.dataset.task);
            const tasksB = Array.from(poolB.querySelectorAll('.task-item')).map(t => t.dataset.task);
            
            // Check for segregation violations
            let conflict = null;
            
            // Cash custody and cash recording with same person
            if (tasksA.includes('cash-custody') && tasksA.includes('cash-record')) {
                conflict = 'Employee A has both cash custody AND cash recording duties. This violates segregation of duties.';
            } else if (tasksB.includes('cash-custody') && tasksB.includes('cash-record')) {
                conflict = 'Employee B has both cash custody AND cash recording duties. This violates segregation of duties.';
            }
            
            // Inventory custody and inventory recording with same person
            if (tasksA.includes('inv-custody') && tasksA.includes('inv-record')) {
                conflict = 'Employee A has both inventory custody AND inventory recording duties. This violates segregation of duties.';
            } else if (tasksB.includes('inv-custody') && tasksB.includes('inv-record')) {
                conflict = 'Employee B has both inventory custody AND inventory recording duties. This violates segregation of duties.';
            }
            
            const alertDiv = document.getElementById('conflict-alert');
            if (conflict) {
                document.getElementById('conflict-message').textContent = conflict;
                alertDiv.classList.add('show');
            } else {
                alertDiv.classList.remove('show');
            }
        }

        function validateSegregation() {
            const poolA = document.getElementById('pool-a');
            const poolB = document.getElementById('pool-b');
            
            const tasksA = Array.from(poolA.querySelectorAll('.task-item')).map(t => t.dataset.task);
            const tasksB = Array.from(poolB.querySelectorAll('.task-item')).map(t => t.dataset.task);
            
            // Check if all tasks are assigned
            const allTasks = [...tasksA, ...tasksB];
            if (allTasks.length < 6) {
                showFeedback('segregation-feedback', 'Please assign all tasks to either Employee A or Employee B.', false);
                return;
            }
            
            // Check for violations
            const hasCashViolation = (tasksA.includes('cash-custody') && tasksA.includes('cash-record')) ||
                                    (tasksB.includes('cash-custody') && tasksB.includes('cash-record'));
            
            const hasInvViolation = (tasksA.includes('inv-custody') && tasksA.includes('inv-record')) ||
                                   (tasksB.includes('inv-custody') && tasksB.includes('inv-record'));
            
            if (hasCashViolation || hasInvViolation) {
                showFeedback('segregation-feedback', '‚ùå Segregation of duties violations detected. The same person should not handle both physical custody and record-keeping for the same asset.', false);
            } else {
                showFeedback('segregation-feedback', '‚úì Perfect! Tasks are properly segregated. No single employee has both custody and recording responsibilities for the same asset.', true);
            }
        }

        function resetSegregation() {
            const taskContainer = document.querySelector('.game-board > div:nth-child(2)');
            const poolA = document.getElementById('pool-a');
            const poolB = document.getElementById('pool-b');
            
            // Move all tasks back to the middle
            const tasks = [...poolA.querySelectorAll('.task-item'), ...poolB.querySelectorAll('.task-item')];
            tasks.forEach(task => {
                taskContainer.appendChild(task);
            });
            
            // Show placeholders
            poolA.querySelector('p').style.display = 'block';
            poolB.querySelector('p').style.display = 'block';
            
            document.getElementById('conflict-alert').classList.remove('show');
            hideFeedback('segregation-feedback');
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // UTILITY FUNCTIONS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        function showFeedback(elementId, message, isCorrect) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = 'feedback ' + (isCorrect ? 'correct' : 'incorrect');
        }

        function hideFeedback(elementId) {
            const element = document.getElementById(elementId);
            element.textContent = '';
            element.className = 'feedback';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Set today's date as default for date inputs
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('petty-date').value = today;
            
            // Initialize petty cash UI
            updatePettyCashUI();
        });

        // Drag end handler
        document.addEventListener('dragend', (e) => {
            if (e.target.classList.contains('task-item')) {
                e.target.classList.remove('dragging');
            }
        });
    </script>
</body>

</html>